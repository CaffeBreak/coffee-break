generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DB_URL")
}

model Player {
  id           String      @id
  name         String
  isDead       Boolean     @default(false)
  ownedRoom    Room?       @relation("owner")
  joinedRoom   Room?       @relation("joinedPlayers", fields: [joinedRoomId], references: [id])
  joinedRoomId String?
  role         PlayerState @default(PENDING)
}

model Room {
  id       String    @id
  password String    @unique
  owner    Player    @relation("owner", fields: [ownerId], references: [id])
  ownerId  String    @unique
  players  Player[]  @relation("joinedPlayers")
  state    RoomState @default(BEFORE_START) // 部屋の状態 現在のフェーズとか
}

enum RoomState {
  BEFORE_START // 参加者待ち
  USING // カード行使
  DISCUSSION // 議論
  VOTING // 投票中
  FINISHED // ゲーム終了後
}

enum PlayerState {
  VILLAGER //村人
  WEREWOLF //人狼
  PENDING //決まっていない
}
